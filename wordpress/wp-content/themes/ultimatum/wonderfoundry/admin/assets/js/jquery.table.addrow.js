(function(e){if(typeof e.fn.btnAddRow=="undefined"){var t=[],n="ExpandableTable";function r(e,t){if(e)this.init(e,t)}r.prototype.init=function(r,i){t.push(this);this.target=e(r).data(n,this);this.maxRow=i;this.seed=Math.round(Math.random()*1e4);this.onAddRow=[];return this};r.prototype.live=function(){if(!this.goLive){var t=this;this.update();e(".addRow"+this.seed).live("click",function(){var e=t.addRow()});e(".delRow"+this.seed).live("click",function(){var n=e(this).closest("."+t.cloneClass),r=n.clone();n.hide().find("*").each(function(t,n){if(e(n).data("destroy"));for(var r in e(n).data("destroy")){e(n).data("destroy")[r](n)}});n.remove();e(".addRow"+t.seed).attr("disabled",false);t.update();if(t.deleteCallBack&&e.isFunction(t.deleteCallBack))t.deleteCallBack(r)});e(".autoAdd"+this.seed).live("keyup",function(){if(this.nodeName.toLowerCase()=="textarea"&&e(this).html()!=""||this.nodeName.toLowerCase()=="textarea"&&e(this).val()!=""||this.nodeName.toLowerCase()=="input"&&e(this).val()!="")t.addRow()});this.goLive=true}return this};r.prototype.updateRowNumber=function(){var t=this;if(t.rowNumColumn){e("."+t.cloneClass,t.target).each(function(n,r){var i=n+1;e("."+t.rowNumColumn,e(r)).each(function(t,n){if(e(n).is(":text, textarea"))e(n).val(i);else e(n).text(i)})})}return t};r.prototype.updateInputBoxName=function(){e("."+this.cloneClass,this.target).each(function(t,n){var r=t+1;e("input,textarea",e(n)).each(function(t,n){if(e(n).attr("name")!=""){var i=e(n).attr("name").replace(/\d+$/,"")+r;e(n).attr("name",i)}})});return this};r.prototype.updateInputBoxId=function(){var t=this;e("."+t.cloneClass,this.target).each(function(t,n){var r=t+1;e("input,textarea",e(n)).each(function(t,n){if(e(n).attr("id")!=""){var i=e(n).attr("id").replace(/\d+$/,"")+r;e(n).removeAttr("id").attr("id",i)}})});return this};r.prototype.updateOddRowCSS=function(){if(this.oddRowCSS){this.target.find("."+this.oddRowCSS).removeClass(this.oddRowCSS);this.target.find("tr:odd").addClass(this.oddRowCSS)}return this};r.prototype.updateEvenRowCSS=function(){if(this.evenRowCSS){this.target.find("."+this.evenRowCSS).removeClass(this.evenRowCSS);this.target.find("tr:even").addClass(this.evenRowCSS)}return this};r.prototype.updateRowCount=function(){if(this.displayRowCountTo){var t=e("."+this.cloneClass,this.target).size();e("."+this.displayRowCountTo,this.target).each(function(n,r){var i=r.nodeName.toLowerCase();if(i=="input"||i=="textarea")e(r).val(t);else e(r).html(t)})}return this};r.prototype.update=function(){var t=this;this.delRowButtons=e(".delRow"+this.seed,this.target);if(this.delRowButtons.size()==1)this.delRowButtons.hide();else{if(this.autoAddRow)this.delRowButtons.not(":last").show();else this.delRowButtons.show()}if(this.autoAddRow){this.target.find(".autoAdd"+this.seed).removeClass("autoAdd"+t.seed);this.target.find("."+t.cloneClass+":last").find("input,textarea").addClass("autoAdd"+this.seed)}if(this.inputBoxAutoNumber){this.updateInputBoxName();this.updateInputBoxId()}if(this.inputBoxAutoId){this.updateInputBoxId()}if(this.hideFirstOnly&&this.hideFirstOnly!=""){e("."+this.cloneClass).eq(0).find("."+this.hideFirstOnly).hide();e("."+this.cloneClass).not(":first").find("."+this.hideFirstOnly).show()}if(this.showFirstOnly&&this.showFirstOnly!=""){e("."+this.cloneClass).eq(0).find("."+this.showFirstOnly).show();e("."+this.cloneClass).not(":first").find("."+this.showFirstOnly).hide()}this.updateRowNumber().updateOddRowCSS().updateEvenRowCSS().updateRowCount();return this};r.prototype.addRow=function(){var t;if(!this.maxRow||this.maxRow&&e("."+this.cloneClass).size()<this.maxRow){this.delRowButtons.show();var n=e("."+this.cloneClass+":last",this.target);this.newRow=t=n.clone();t.find("input:text").val("");t.find("textarea").text("");if(this.autoAddRow)t.find("."+this.cloneClass).hide();t.insertAfter(n);if(this.ignoreClass&&this.ignoreClass!=""){t.find("."+this.ignoreClass).each(function(){if(this.nodeName.toLowerCase()=="input"&&(e(this).attr("type").toLowerCase()=="text"||e(this).attr("type").toLowerCase()=="hidden"))e(this).val("");else if(this.nodeName.toLowerCase()=="td")e(this).html(" ");else if(e(this).html()!="")e(this).text("")})}t.find("input:hidden").not("."+this.cloneClass).val("");if(this.hideFirstOnly&&this.hideFirstOnly!=""){t.find("."+this.hideFirstOnly).show()}if(this.showFirstOnly&&this.showFirstOnly!=""){t.find("."+this.hideFirstOnly).hide()}if(this.maxRow&&e("."+this.cloneClass).size()>=this.maxRow)e(".addRow"+this.seed).attr("disabled",true);this.target.find("."+this.cloneClass+":first").closest("tr").find("*").each(function(n,r){if(e(this).data("init")){var i=t.find("*").eq(n),s=i[0];i.data("init",{});for(var o in e(this).data("init")){i.data("init")[o]=e(this).data("init")[o];i.data("init")[o](s)}}});this.update()}if(this.addCallBack&&e.isFunction(this.addCallBack))this.addCallBack(t);return t};e.fn.btnAddRow=e.fn.tableAutoAddRow=function(i,s){var o;if(typeof i=="object")o=s&&e.isFunction(s)?s:null;else o=i&&e.isFunction(i)?i:null;i=e.extend({maxRow:null,ignoreClass:null,rowNumColumn:null,autoAddRow:false,oddRowCSS:null,evenRowCSS:null,inputBoxAutoNumber:false,inputBoxAutoId:false,displayRowCountTo:null,maxRowAttr:null,hideFirstOnly:null,showFirstOnly:null,cloneClass:null,evenRowAttr:null,oddRowAttr:null,rowCountAttr:null,autoNumAttr:null,autoIdAttr:null},i);this.each(function(){var t,s,u;if(typeof i.cloneClass=="string"&&i.cloneClass!=""){if(e(this).closest("table").find("."+i.cloneClass).size()>0){t=e(this).closest("table");u=i.cloneClass}else if(e(this).closest("."+i.cloneClass).size()>0){t=e(this).closest("."+i.cloneClass).closest("table");u=i.cloneClass}else{t=this.nodeName.toLowerCase()=="table"?e(this):e(this).closest("table")}}else{t=this.nodeName.toLowerCase()=="table"?e(this):e(this).closest("table")}if(i.maxRowAttr&&typeof e(this).attr(i.maxRowAttr)!="undefined")i.maxRow=e(this).attr(i.maxRowAttr);if(i.oddRowAttr&&typeof e(this).attr(i.oddRowAttr)!="undefined")i.oddRowCSS=e(this).attr(i.oddRowAttr);if(i.evenRowAttr&&typeof e(this).attr(i.evenRowAttr)!="undefined")i.evenRowCSS=e(this).attr(i.evenRowAttr);if(i.rowCountAttr&&typeof e(this).attr(i.rowCountAttr)!="undefined")i.displayRowCountTo=e(this).attr(i.rowCountAttr);if(i.autoNumAttr&&typeof e(this).attr(i.autoNumAttr)!="undefined")i.inputBoxAutoNumber=e(this).attr(i.autoNumAttr);if(i.autoIdAttr&&typeof e(this).attr(i.autoIdAttr)!="undefined")i.inputBoxAutoId=e(this).attr(i.autoIdAttr);if(t.size()>0){if(typeof t.data(n)==="undefined"||t.data(n)===null){s=new r(t,i.maxRow);if(this.nodeName.toLowerCase()!="table")e(this).addClass("addRow"+s.seed).data(n,s)}else{if(this.nodeName.toLowerCase()!="table")e(this).addClass("addRow"+t.data(n).seed).data(n,t.data(n))}if(e(this).data(n)){s=e(this).data(n)}s.maxRow=i.maxRow;s.maxRow=i.maxRow;s.ignoreClass=i.ignoreClass;s.rowNumColumn=i.rowNumColumn;s.oddRowCSS=i.oddRowCSS;s.evenRowCSS=i.evenRowCSS;s.autoAddRow=i.autoAddRow;s.inputBoxAutoNumber=i.inputBoxAutoNumber;s.displayRowCountTo=i.displayRowCountTo;s.hideFirstOnly=i.hideFirstOnly;s.showFirstOnly=i.showFirstOnly;if(typeof u=="string"&&s.cloneClass!=u){s.cloneClass=u}else{s.cloneClass="cloneRow"+s.seed}s.updateRowCount();s.addCallBack=o}});for(var u=0;u<t.length;u++){if(!t[u].goLive){t[u].live()}}};e.fn.btnDelRow=function(i,s){var o;if(typeof i=="object")o=s&&e.isFunction(s)?s:null;else o=i&&e.isFunction(i)?i:null;i=e.extend({cloneClass:null},i);this.each(function(){var t,s,u;if(e(this).closest("."+i.cloneClass).size()>0){s=e(this).closest("."+i.cloneClass).closest("table");u=i.cloneClass}else{s=e(this).hide().closest("table")}if(s.size()>0){if(typeof s.data(n)==="undefined"||s.data(n)===null){t=new r(s);e(this).addClass("delRow"+t.seed).data(n,t)}else{e(this).addClass("delRow"+s.data(n).seed).data(n,s.data(n))}if(e(this).data(n)){t=e(this).data(n);t.deleteCallBack=o}if(!(typeof t.cloneClass=="string"&&t.cloneClass!="")){t.cloneClass="cloneRow"+t.seed;e(this).closest("tr").addClass("cloneRow"+t.seed)}else if(typeof u=="string"){t.cloneClass=u}else{t.cloneClass="cloneRow"+t.seed;e(this).closest("tr").addClass("cloneRow"+t.seed)}t.update()}});for(var u=0;u<t.length;u++){if(!t[u].goLive){t[u].live()}}}}})(jQuery)